Sub SendEmailWithSheetContents()
    Dim outlookApp As Object
    Dim outlookMail As Object
    Dim rng As Range
    Dim strbody As String
    
    ' 创建Outlook应用实例
    Set outlookApp = CreateObject("Outlook.Application")
    Set outlookMail = outlookApp.CreateItem(0)
    
    ' 定义要发送的区域，这里选择的是整个活动工作表
    With ActiveSheet
        Set rng = .UsedRange ' 可以根据需要调整为特定的范围
        strbody = rng.Value ' 这里假设邮件正文是单元格的内容
    End With
    
    ' 配置邮件参数
    With outlookMail
        .To = "receiver@example.com"  ' 收件人邮箱地址
        .CC = ""  ' 抄送地址，如果不需要可以留空
        .BCC = "" ' 密送地址，如果不需要可以留空
        .Subject = "这是通过Excel VBA发送的邮件"  ' 邮件主题
        .Body = strbody  ' 邮件正文
        .Send   ' 发送邮件
    End With
    
    ' 清理对象
    Set outlookMail = Nothing
    Set outlookApp = Nothing
End Sub